{% extends "base.html" %}
{% block title %}Parini - Clothing Shop{% endblock %}
{% block main %}
  {% if show_search_modal %}
  <div class="search-modal-overlay" style="position:fixed;top:0;left:0;right:0;bottom:0;z-index:9999;background:rgba(26,24,22,0.92);display:flex;align-items:center;justify-content:center;padding:2rem;">
    <a href="{{ url_for('index') }}" style="position:absolute;inset:0;z-index:1;" aria-label="Close search"></a>
    <div class="search-modal-content" style="background:var(--color-cream);border-radius:12px;width:100%;max-width:1000px;max-height:90vh;overflow-y:auto;position:relative;z-index:2;box-shadow:0 8px 32px rgba(0,0,0,0.3);">
      <div style="position:sticky;top:0;background:var(--color-cream);padding:1.5rem 2rem;border-bottom:2px solid var(--color-sand);display:flex;justify-content:space-between;align-items:center;z-index:10;">
        <div>
          <h2 style="font-family:var(--font-display);font-size:1.75rem;margin:0;color:var(--color-charcoal);">Search results</h2>
          <p style="color:var(--color-muted);margin:0.5rem 0 0 0;font-size:0.95rem;">Found {{ search_results|length }} item{{ 's' if search_results|length != 1 else '' }} for "<strong>{{ current_search }}</strong>"</p>
        </div>
        <a href="{{ url_for('index') }}" style="width:36px;height:36px;border-radius:50%;background:var(--color-sand);display:flex;align-items:center;justify-content:center;color:var(--color-charcoal);font-size:1.5rem;text-decoration:none;cursor:pointer;transition:background 0.2s;position:relative;z-index:11;" onmouseover="this.style.background='var(--color-terracotta)';this.style.color='white'" onmouseout="this.style.background='var(--color-sand)';this.style.color='var(--color-charcoal)'">&times;</a>
      </div>
      <div style="padding:2rem;">
        {% if search_results %}
        <div class="product-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:1.5rem;">
          {% for p in search_results %}
          <article class="product-card" style="background:white;border:2px solid var(--color-sand);border-radius:var(--radius);overflow:hidden;transition:transform 0.2s,box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-4px)';this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
            <a href="{{ url_for('product_detail', pid=p.id) }}" class="product-image-link" style="display:block;text-decoration:none;color:inherit;">
              <img class="product-image" src="{{ url_for('product_image', image_id=p.image) }}" alt="{{ p.name }}" loading="lazy" style="width:100%;aspect-ratio:3/4;object-fit:cover;">
            </a>
            <div class="product-info" style="padding:1rem;">
              <span class="product-category" style="font-size:0.8rem;color:var(--color-muted);text-transform:uppercase;display:block;margin-bottom:0.25rem;">{{ p.category }}</span>
              <h3 class="product-name" style="font-size:0.95rem;margin:0 0 0.5rem 0;font-weight:500;line-height:1.3;">
                <a href="{{ url_for('product_detail', pid=p.id) }}" style="color:inherit;text-decoration:none;">{{ p.name }}</a>
              </h3>
              <p class="product-price" style="font-size:1rem;font-weight:600;color:var(--color-charcoal);margin:0;">₹{{ "{:,}".format(p.price) }}</p>
            </div>
          </article>
          {% endfor %}
        </div>
        {% else %}
        <div style="text-align:center;padding:4rem 2rem;">
          <p style="font-size:1.1rem;color:var(--color-muted);margin-bottom:0.5rem;">No products found</p>
          <p style="color:var(--color-muted);font-size:0.95rem;">Try searching for something else</p>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}
  <section id="home" class="hero">
    <div class="hero-content">
      <p class="hero-tag">2025 Collection</p>
      <h1 class="hero-title">Simple Styles<br>For Daily Wear</h1>
      <p class="hero-desc">This project shows a basic clothing store flow with categories, cart, and checkout pages.</p>
      <a href="#shop" class="btn btn-primary">Shop Now</a>
    </div>
    <div class="hero-visual" style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;max-width:100%;">
      {% for dress in random_dresses %}
      <article class="product-card" style="background:var(--color-cream);border:2px solid var(--color-sand);border-radius:var(--radius);overflow:hidden;">
        <a href="{{ url_for('product_detail', pid=dress.id) }}" class="product-image-link" style="display:block;text-decoration:none;color:inherit;">
          <img class="product-image" src="{{ url_for('product_image', image_id=dress.image) }}" alt="{{ dress.name }}" loading="lazy" style="width:100%;aspect-ratio:3/4;object-fit:cover;">
        </a>
        <div class="product-info" style="padding:1rem;">
          <span class="product-category" style="font-size:0.85rem;color:var(--color-muted);text-transform:uppercase;">{{ dress.category }}</span>
          <h3 class="product-name" style="font-size:1rem;margin:0.5rem 0;font-weight:500;">
            <a href="{{ url_for('product_detail', pid=dress.id) }}" style="color:inherit;text-decoration:none;">{{ dress.name }}</a>
          </h3>
            <p class="product-price" style="font-size:1rem;font-weight:600;color:var(--color-charcoal);margin:0;">₹{{ "{:,}".format(dress.price) }}</p>
        </div>
      </article>
      {% endfor %}
    </div>
  </section>

  <section id="categories" class="categories">
    <h2 class="section-title">Shop by Category</h2>
    <div class="category-grid">
      <a href="{{ url_for('category_page', category_name='dresses') }}" class="category-card">
        <div class="category-img category-dresses"></div>
        <span class="category-name">Dresses</span>
      </a>
      <a href="{{ url_for('category_page', category_name='tops') }}" class="category-card">
        <div class="category-img category-tops"></div>
        <span class="category-name">Tops</span>
      </a>
      <a href="{{ url_for('category_page', category_name='bottoms') }}" class="category-card">
        <div class="category-img category-bottoms"></div>
        <span class="category-name">Bottoms</span>
      </a>
      <a href="{{ url_for('category_page', category_name='accessories') }}" class="category-card">
        <div class="category-img category-accessories"></div>
        <span class="category-name">Accessories</span>
      </a>
    </div>
  </section>

  <section class="collection">
    <h2 class="section-title">Featured Products</h2>
    <div class="product-grid">
      {% for p in featured %}
      <article class="product-card">
        <a href="{{ url_for('product_detail', pid=p.id) }}" class="product-image-link" style="display:block;text-decoration:none;color:inherit;">
          <img class="product-image" src="{{ url_for('product_image', image_id=p.image) }}" alt="{{ p.name }}" loading="lazy">
        </a>
        <div class="product-info">
          <span class="product-category">{{ p.category }}</span>
          <h3 class="product-name"><a href="{{ url_for('product_detail', pid=p.id) }}" style="color:inherit;text-decoration:none;">{{ p.name }}</a></h3>
          <p class="product-price">₹{{ "{:,}".format(p.price) }}</p>
          <a href="{{ url_for('product_detail', pid=p.id) }}" class="btn btn-primary btn-add-cart">View Product</a>
        </div>
      </article>
      {% endfor %}
    </div>
    <p class="section-cta"><a href="#shop" class="btn btn-outline">See All Products</a></p>
  </section>

  <section id="shop" class="shop-section">
    <h2 class="section-title">Shop All</h2>
    <form class="shop-filters" action="{{ url_for('index') }}#shop" method="get">
      <input type="hidden" name="search" value="{{ current_search }}">
      <div class="filter-group">
        <label>Category</label>
        <select name="category">
          {% for c in categories %}
          <option value="{{ c.id }}" {% if c.id == current_category %}selected{% endif %}>{{ c.label }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="filter-group">
        <label>Min price</label>
        <input type="number" name="minPrice" placeholder="₹0" min="0" step="100" value="{{ current_min_price }}">
      </div>
      <div class="filter-group">
        <label>Max price</label>
        <input type="number" name="maxPrice" placeholder="₹10000" min="0" step="100" value="{{ current_max_price }}">
      </div>
      <div class="filter-group" style="align-self:flex-end;">
        <button type="submit" class="btn btn-primary">Apply</button>
      </div>
    </form>
    <div class="product-grid">
      {% if products %}
      {% for p in products %}
      <article class="product-card">
        <a href="{{ url_for('product_detail', pid=p.id) }}" class="product-image-link" style="display:block;text-decoration:none;color:inherit;">
          <img class="product-image" src="{{ url_for('product_image', image_id=p.image) }}" alt="{{ p.name }}" loading="lazy">
        </a>
        <div class="product-info">
          <span class="product-category">{{ p.category }}</span>
          <h3 class="product-name"><a href="{{ url_for('product_detail', pid=p.id) }}" style="color:inherit;text-decoration:none;">{{ p.name }}</a></h3>
          <p class="product-price">₹{{ "{:,}".format(p.price) }}</p>
          <a href="{{ url_for('product_detail', pid=p.id) }}" class="btn btn-primary btn-add-cart">View Product</a>
        </div>
      </article>
      {% endfor %}
      {% else %}
      <p class="no-results" style="grid-column:1/-1;">No products match your filters. Try adjusting or clearing filters.</p>
      {% endif %}
    </div>
  </section>

  <section id="about" class="about">
    <div class="about-content">
      <h2 class="section-title">About This Project</h2>
      <p class="about-text">This is a mini e-commerce project built with Flask to practice routing, forms, and session handling.</p>
      <a href="#contact" class="btn btn-outline">Contact</a>
    </div>
  </section>

  <section id="contact" class="contact">
    <div class="contact-inner">
      <h2 class="section-title">Project Updates</h2>
      <p class="contact-desc">Subscribe if you want updates when we improve this mini project.</p>
      <form class="newsletter-form" action="{{ url_for('newsletter') }}" method="post">
        <input type="email" name="email" placeholder="Your email" required>
        <button type="submit" class="btn btn-primary">Subscribe</button>
      </form>
      <div class="contact-links">
        <a href="https://www.instagram.com/dhanalakshmicollegeofengg/" target="_blank" rel="noopener noreferrer">Instagram</a>
        <a href="{{ url_for('store_locator_page') }}">Store Locator</a>
        <a href="{{ url_for('shipping_page') }}">Shipping & Returns</a>
        <a href="{{ url_for('faq_page') }}">FAQ</a>
      </div>
    </div>
  </section>
{% endblock %}
